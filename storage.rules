rules_version = '2';

// Firebase Storage Rules for MessageAI
service firebase.storage {
  match /b/{bucket}/o {
    
    // Profile Pictures
    match /profile_pictures/{fileName} {
      // Anyone authenticated can read profile pictures
      allow read: if request.auth != null;
      
      // Users can only write their own profile picture
      // fileName format: profile_{userID}.jpg
      allow write: if request.auth != null 
        && fileName.matches('profile_' + request.auth.uid + '.jpg');
    }
    
    // Conversation Images (messages)
    match /conversations/{conversationId}/{fileName} {
      // Anyone authenticated can read
      allow read: if request.auth != null;
      
      // Anyone authenticated can write (we'll check conversation membership in app logic)
      allow write: if request.auth != null;
    }
    
    // Voice Messages (if you add them later)
    match /voice_messages/{conversationId}/{fileName} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
  }
}

